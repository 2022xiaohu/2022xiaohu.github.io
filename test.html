<!DOCTYPE html>
<html>
<script type="text/javascript" src="./js/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="./js/jquery.tablesorter.min.js"></script>

<link type="text/css" rel="stylesheet" href="./css/fupan_css.css">
<link type="text/css" rel="stylesheet" href="./css/calendar.css">
<link type="text/css" rel="stylesheet" href="./kpl/com.css">
<link type="text/css" rel="stylesheet" href="./kpl/index.css">
<link type="text/css" rel="stylesheet" href="./kpl/fChart.css">
<link type="text/css" rel="stylesheet" href="./kpl/mpage.css">

<script src="./js/update.js"></script>
<script src="./js/show_message.js"></script>

<script src="./js/kaipanla.js"></script>

<!-- <script src="./kpl/jquery.js"></script> -->
<script src="./kpl/com.js"></script>
<!--分时-->
<script src="./kpl/floatMChart.js"></script>
<!--K线-->
<script src="./kpl/floatKChart.js"></script>
<script src="./kpl/fChart.js"></script>

<script src="./js/xlsx.js"></script>

<body>
    <input type="file" id="file" style="display: none;"/>
    <button class="btn_color" onclick="importBatch()">批量导入</button>
    
    <script type="text/javascript">
        function importBatch(){
            document.getElementById('file').click();
        }
        
        // 读取本地excel文件
        function readWorkbookFromLocalFile(file, callback) {
            var reader = new FileReader();
            reader.onload = function(e) {
                var data = e.target.result;
                var workbook = XLSX.read(data, {type: 'binary'});
                if(callback) callback(workbook);
            };
            reader.readAsBinaryString(file);
        }	
        
        
        function readWorkbook(workbook) {
                var sheetNames = workbook.SheetNames; // 工作表名称集合
                var worksheet = workbook.Sheets[sheetNames[0]]; // 这里我们只读取第一张sheet
                var excelData = XLSX.utils.sheet_to_json(worksheet);
                
                // 输出导入的excel信息
                console.log(excelData);
            }
            
        // 增加上传文件事件
            document.getElementById('file').addEventListener('change', function(e) {
                var files = e.target.files;
                if (files.length === 0) {
                    return;
                }
                var f = files[0];
                //此处支持的格式可以自己设置
                if (!(/\.xlsx$/g.test(f.name))&&!(/\.xls$/g.test(f.name))) {
                    alert('仅支持读取xls格式或者xlsx格式');
                    return;
                }
                readWorkbookFromLocalFile(f, function(workbook) {
                    readWorkbook(workbook);
                });
            });
    </script>
</body>


<script>
    $(document).ready(function () {
    ajaxUrl();
});
</script>

<script>
    function ajaxUrl() {
        var url = "https://raw.githubusercontent.com/2022xiaohu/2022xiaohu.github.io/main/2021-06-02.xls";	
	    var htmlobj= $.ajax({url:url,async:false});
        console.log(htmlobj.responseText);
    }

  </script>

</html>